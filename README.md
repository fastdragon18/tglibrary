# tglibrary

**tglibrary** æ˜¯ä¸€ä¸ªä½¿ç”¨Flaskç¼–å†™çš„åŸºäº Telegram Bot API çš„åª’ä½“æ–‡ä»¶å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œè®©æ‚¨èƒ½å¤Ÿè½»æ¾ä¸Šä¼ ã€ç®¡ç†å’Œåˆ†äº«å›¾ç‰‡å’Œè§†é¢‘æ–‡ä»¶ï¼Œå¹¶çªç ´ Telegram çš„ 20MB æ–‡ä»¶å¤§å°é™åˆ¶ã€‚
# ä¸»é¡µæˆªå›¾ï¼š
![ä¸»é¡µæˆªå›¾](https://img.888888.fit/d/AgACAgUAAxkDAAMCZ96TkTSBUMoJAvENglfCT3pxg9QAAsnBMRuvEPlWYiEAAaQw3YhoAQADAgADdwADNgQ)
# åå°æˆªå›¾ï¼š
![åå°æˆªå›¾](https://img.888888.fit/d/AgACAgUAAxkDAAMDZ96Tq54oaHlpwgS8nTw51rqud3MAAsrBMRuvEPlWBuSIQ2cdUusBAAMCAAN3AAM2BA)

## å½“å‰æ‰€æœ‰ç‰ˆæœ¬åŒ…æ‹¬æ‰“åŒ…ç‰ˆå‡ä¸ä¿è¯ç¨³å®šæ€§,å»ºè®®ä½¿ç”¨dockerç‰ˆæœ¬,å¦‚æœ‰é—®é¢˜åŠæ—¶æäº¤lssuse,æˆ‘ä¼šåŠæ—¶ä¿®å¤ï¼ï¼ï¼

å‰ç«¯éƒ¨åˆ†å€Ÿé‰´[SkyDependence](https://github.com/SkyDependence/)å¤§ä½¬çš„å‰ç«¯ï¼Œå¤§ä½¬çš„[tgDrive](https://github.com/SkyDependence/tgDrive)ä¹Ÿæ˜¯ä¸é”™çš„é¡¹ç›®ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå‰å¾€æŸ¥çœ‹

## ç‰¹æ€§

* ğŸ–¼ï¸ æ”¯æŒå›¾ç‰‡ä¸Šä¼ å’Œå­˜å‚¨
* ğŸ¬ æ”¯æŒè§†é¢‘ä¸Šä¼ å’Œå­˜å‚¨
* ğŸ“Š çªç ´ Telegram 20MB æ–‡ä»¶å¤§å°é™åˆ¶
* ğŸ”— ç”Ÿæˆå¯ç›´æ¥è®¿é—®çš„æ–‡ä»¶é“¾æ¥
* ğŸ“‚ æ–‡ä»¶ç®¡ç†åŠŸèƒ½
* ğŸ”’ å®‰å…¨çš„ç§äººå­˜å‚¨ç©ºé—´
* ğŸ’» ç®€å•æ˜“ç”¨çš„å‘½ä»¤æ¥å£

## å·¥ä½œåŸç†

tglibrary åˆ©ç”¨ Telegram Bot API ä½œä¸ºåç«¯å­˜å‚¨ç³»ç»Ÿï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°åŠŸèƒ½ï¼š

1. **æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ** - å¯¹äºè¶…è¿‡ 20MB çš„è§†é¢‘æ–‡ä»¶ï¼Œtglibrary ä¼šè‡ªåŠ¨å°†å…¶åˆ†å‰²æˆå¤šä¸ªTSè¿›è¡Œä¸Šä¼ ï¼Œæ’­æ”¾æ—¶è°ƒç”¨m3u8è¿›è¡Œæ’­æ”¾
2. **å…ƒæ•°æ®ç®¡ç†** - ä¸ºæ¯ä¸ªæ–‡ä»¶ç»´æŠ¤è¯¦ç»†çš„å…ƒæ•°æ®è®°å½•ï¼Œä¾¿äºå¿«é€Ÿæ£€ç´¢
3. **ç›´æ¥é“¾æ¥ç”Ÿæˆ** - ä¸ºæ‰€æœ‰ä¸Šä¼ çš„åª’ä½“æ–‡ä»¶ç”Ÿæˆç›´æ¥å¯è®¿é—®çš„é“¾æ¥

## å®‰è£…

ä¸‹è½½å­˜å‚¨åº“ä¸­çš„ tglibrary äºŒè¿›åˆ¶æ–‡ä»¶

## é…ç½®

åœ¨ä½¿ç”¨ tglibrary å‰ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª Telegram Bot å¹¶è·å– API Tokenã€‚

1. åœ¨ Telegram ä¸­ä¸ @BotFather èŠå¤©åˆ›å»ºæ–°çš„ Bot
2. è·å– API Token
3. åœ¨ Telegram ä¸­ä¸ @get_myidbot èŠå¤©è·å–ä½ çš„ CHAT_ID
4. ç¨‹åºè‡ªåŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶ `config.json`ï¼Œè¯·è‡ªè¡Œæ›´æ”¹ï¼š

```json
{
    "TOKEN": "telegram_bot_token",
    "CHAT_ID": "chat_id",
    "PASSWORD": "admin",
    "PORT": 5000,
    "MAX_VIDEO_SIZE_MB": 20,
    "SEGMENT_SIZE_MB": 10
}
```
é»˜è®¤å¯†ç ä¸ºï¼šadmin
## ä½¿ç”¨æ–¹æ³•

### Dockeréƒ¨ç½²(æ¨è)
```bash
docker push sulong/tglibrary:0.0.1
docker run -d -p 5000:5000 --name tglibrary sulong/tglibrary:0.0.1
```
ç¨‹åºè¿è¡Œè‡ªåŠ¨åˆ›å»ºconfig.json ä¹Ÿå¯ä»¥è‡ªè¡Œå¤åˆ¶config.jsonï¼Œä¿®æ”¹å®Œæˆååˆå¹¶dockerè¿è¡Œä¸€èµ·è¿è¡Œ
```bash
docker run -d -p 5000:5000 --name tglibrary -v $(pwd)/config.json:/app/config.json sulong/tglibrary:0.0.1
```
Dockeréƒ¨ç½²ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¦‚æœä½ é‡åˆ°é—®é¢˜æœ‰ç›¸å…³çš„è§£å†³æ–¹æ¡ˆï¼Œæ¬¢è¿åŠæ—¶lssuseï¼Œè°¢è°¢ï¼
### å‘½ä»¤è¡Œä½¿ç”¨

```bash
# è¿è¡Œtglibrary
./tglibrary
```

### ä½œä¸ºç³»ç»ŸæœåŠ¡è¿è¡Œ

æ‚¨å¯ä»¥å°† tglibrary è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡ï¼Œä½¿å…¶åœ¨åå°æŒç»­è¿è¡Œã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ systemd é…ç½®çš„æ–¹æ³•ï¼š

1. åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼š

```bash
sudo nano /etc/systemd/system/tglibrary.service
```

2. æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```ini
[Unit]
Description=Telegram Library Media Storage
After=network.target

[Service]
Type=simple
User=YOUR_USERNAME
WorkingDirectory=/path/to/tglibrary
ExecStart=/path/to/tglibrary
Restart=always
RestartSec=5
StandardOutput=syslog
StandardError=syslog
SyslogIdentifier=tglibrary

[Install]
WantedBy=multi-user.target
```

3. å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl daemon-reload
sudo systemctl enable tglibrary
sudo systemctl start tglibrary
```

4. æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š

```bash
sudo systemctl status tglibrary
```

### å¸¸ç”¨æœåŠ¡ç®¡ç†å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start tglibrary

# åœæ­¢æœåŠ¡
sudo systemctl stop tglibrary

# é‡å¯æœåŠ¡
sudo systemctl restart tglibrary

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u tglibrary -f
```

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿ tglibrary å…·æœ‰æ‰§è¡Œæƒé™ï¼š`chmod +x /path/to/tglibrary`
- é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»º`config.json` è¯·æ ¹æ®ä½ è·å–çš„ `API Token` å’Œ `CHAT_ID` æ­£ç¡®é…ç½® `config.json`
- ç³»ç»ŸæœåŠ¡è¿è¡Œæ—¶å°†ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„å­˜å‚¨è·¯å¾„

## åä»£è®¾ç½®
Nginx
```bash
server {
    listen 80;
    server_name your-domain.com;
    
    # è®¾ç½®æœ€å¤§ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸º100MB
    client_max_body_size 100M;
    
    location / {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## æ”¯æŒä¸åé¦ˆ
å¦‚æœæ‚¨è§‰å¾—æœ¬é¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ï¼š

* â­ ç»™é¡¹ç›®ç‚¹ä¸ª Star
* ğŸ”„ åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹
* ğŸ› æäº¤ Issue
* æ‚¨çš„æ”¯æŒæ˜¯é¡¹ç›®æŒç»­å‘å±•çš„åŠ¨åŠ›ï¼
